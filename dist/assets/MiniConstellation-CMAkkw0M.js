import{j as n,a as P,O as L}from"./three-vendor-B0HHzWfL.js";import{b as o,u as A,j as m}from"./react-vendor-DaKsb8LL.js";import{y as R,a as k,z,c as B}from"./constellation-C0uHALRD.js";import{N as D,C as _}from"./node-view-BzXQZrZ3.js";const F=o.forwardRef((T,b)=>{const v=A(),c=m(R),s=m(k),r=m(z),M=o.useRef(null),[C,d]=o.useState(!1),l=o.useMemo(()=>`mini-constellation-canvas-${Date.now()}`,[]);o.useEffect(()=>()=>{var e;try{const t=document.getElementById(l);if(t&&t instanceof HTMLCanvasElement){const i=t.getContext("webgl")||t.getContext("webgl2");i&&((e=i.getExtension("WEBGL_lose_context"))==null||e.loseContext())}}catch(t){console.warn("Error cleaning up WebGL context:",t)}},[l]);const I=o.useMemo(()=>r.map(e=>({source:e.start,target:e.end})),[r]),w=o.useMemo(()=>{const e=new Set;return s&&r.forEach(t=>{t.start===s?e.add(t.end):t.end===s&&e.add(t.start)}),Array.from(e)},[r,s]),y=e=>{v(B(e))},a=o.useMemo(()=>{const e={};return c.forEach((t,i)=>{const E=c.length,u=3,g=2/E,N=Math.PI*(3-Math.sqrt(5)),p=i*g-1+g/2,h=Math.sqrt(1-p*p),x=i*N,j=Math.cos(x)*h*u,S=Math.sin(x)*h*u;e[t.id]=[j,p*u,S]}),e},[c]),f=o.useMemo(()=>({updatePositions:(e,t)=>a,getCurrentPositions:()=>a}),[a]);return n.jsx("div",{ref:b,className:"mini-constellation-container",style:{width:"100%",height:"100%",borderRadius:"8px",cursor:C?"grabbing":"grab",boxShadow:"0 0 10px rgba(0,0,0,0.3)",backgroundColor:"rgba(0,0,0,0.1)",border:"1px solid rgba(255,255,255,0.2)",zIndex:1e3,pointerEvents:"auto",padding:0,margin:0,overflow:"hidden",position:"relative"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 0 15px rgba(255,255,255,0.3)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 0 10px rgba(0,0,0,0.3)",d(!1)},children:n.jsxs(P,{id:l,frameloop:"always",style:{width:"100%",height:"100%",cursor:"grab",touchAction:"none"},camera:{position:[0,0,8],fov:35,near:.1,far:100},gl:{antialias:!0,alpha:!0,powerPreference:"default",preserveDrawingBuffer:!0},dpr:[1,2],performance:{min:.5},children:[n.jsx("ambientLight",{intensity:.8}),n.jsx("pointLight",{position:[10,10,10],intensity:1}),n.jsx("pointLight",{position:[-10,-10,10],intensity:.5}),n.jsx(L,{enableZoom:!1,enablePan:!1,rotateSpeed:1.5,enableDamping:!0,dampingFactor:.1,minPolarAngle:0,maxPolarAngle:Math.PI,onStart:()=>d(!0),onEnd:()=>d(!1),target:[0,0,0]}),n.jsxs("group",{scale:[.6,.6,.6],children:[n.jsx(D,{ref:M,nodes:c,nodePositions:a,connections:r,overrideSelectedNodeId:s??void 0,onNodeClick:y,clickableNodeIds:w,isMinimap:!0,isInitialChoicePhase:!1,triumvirateActive:!1,triumvirateNodes:[],positionSynchronizer:f}),n.jsx(_,{connections:I,nodePositions:a,selectedNodeId:s,hoveredNodeId:null,positionSynchronizer:f,isMinimap:!0})]})]})})});export{F as default};
//# sourceMappingURL=MiniConstellation-CMAkkw0M.js.map
